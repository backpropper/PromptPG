Epoch: 0
Batch: 0
cids for sample[-1] in batch: [19 15]
Cand prob for sample[-1] in batch: [0.07333, 0.06704, 0.02929, 0.02368, 0.0361, 0.06504, 0.02967, 0.05743, 0.03535, 0.04353, 0.01979, 0.03572, 0.03706, 0.11336, 0.04516, 0.05434, 0.03145, 0.05846, 0.08522, 0.05898]
### reward for the batch: 4
### loss for the batch: 25.17125129699707

Batch: 1
cids for sample[-1] in batch: [ 7 18]
Cand prob for sample[-1] in batch: [0.02866, 0.04229, 0.03641, 0.02282, 0.04749, 0.00914, 0.01726, 0.05301, 0.00442, 0.03384, 0.01515, 0.00595, 0.03415, 0.10515, 0.01339, 0.02258, 0.02877, 0.05212, 0.35736, 0.07004]
### reward for the batch: 10
### loss for the batch: 44.69661331176758

Batch: 2
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.04283, 0.02938, 0.13613, 0.02571, 0.02672, 0.00421, 0.04845, 0.04254, 0.00043, 0.03535, 0.01408, 0.00037, 0.02802, 0.06308, 0.00497, 0.01019, 0.02344, 0.04701, 0.39125, 0.0258]
### reward for the batch: 8
### loss for the batch: 32.34783935546875

Batch: 3
cids for sample[-1] in batch: [2 9]
Cand prob for sample[-1] in batch: [0.09165, 0.06492, 0.29174, 0.01825, 0.01369, 0.00306, 0.06457, 0.01856, 3e-05, 0.05073, 0.00702, 2e-05, 0.00269, 0.00918, 0.00087, 0.00303, 0.00305, 0.04594, 0.26519, 0.04579]
### reward for the batch: 4
### loss for the batch: 10.767488479614258

Batch: 4
cids for sample[-1] in batch: [ 9 18]
Cand prob for sample[-1] in batch: [0.00129, 0.01482, 0.04489, 0.00034, 0.00036, 0.00042, 0.00058, 0.00274, 0.0, 0.03171, 0.0003, 0.0, 0.00068, 0.00117, 0.00012, 0.00011, 0.0009, 0.0087, 0.85142, 0.03947]
### reward for the batch: 2
### loss for the batch: 5.285533905029297

Batch: 5
cids for sample[-1] in batch: [19 18]
Cand prob for sample[-1] in batch: [0.00025, 0.01155, 0.03279, 0.00011, 0.00019, 0.00022, 3e-05, 0.001, 0.0, 0.01844, 0.00012, 0.0, 0.00034, 0.00026, 4e-05, 4e-05, 0.00056, 0.00329, 0.74695, 0.18382]
### reward for the batch: 8
### loss for the batch: 15.197765350341797

Batch: 6
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 0.00144, 0.00198, 0.0, 0.0, 2e-05, 0.0, 9e-05, 0.0, 0.00286, 0.0, 0.0, 2e-05, 1e-05, 0.0, 0.0, 2e-05, 0.0004, 0.12763, 0.86551]
### reward for the batch: 2
### loss for the batch: 0.2507905960083008

Batch: 7
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 0.00023, 0.00018, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00033, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.00254, 0.99669]
### reward for the batch: 4
### loss for the batch: 23.530071258544922

============================================
### Epoch: 0 / 20
### Total reward: 42, Total loss: 157.24735, Best reward: 42 at epoch 0, Best loss: 157.24735 at epoch 0

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_0.pt
saved the best reward ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_reward.pt
saved the best loss ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_loss.pt
CacheInfo(hits=0, misses=160, maxsize=10000, currsize=160)
============================================

Epoch: 1
Batch: 0
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 6e-05, 1e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00025, 0.99959]
### reward for the batch: 4
### loss for the batch: 30.401561737060547

Batch: 1
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 4e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00016, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01579, 0.98401]
### reward for the batch: 8
### loss for the batch: 36.89120864868164

Batch: 2
cids for sample[-1] in batch: [ 9 18]
Cand prob for sample[-1] in batch: [0.0, 2e-05, 1e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00023, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 2e-05, 1e-05, 0.97429, 0.02542]
### reward for the batch: 10
### loss for the batch: 14.430490493774414

Batch: 3
cids for sample[-1] in batch: [19 18]
Cand prob for sample[-1] in batch: [0.0, 0.00024, 3e-05, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.00184, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 3e-05, 6e-05, 0.85337, 0.14439]
### reward for the batch: 2
### loss for the batch: 13.058329582214355

Batch: 4
cids for sample[-1] in batch: [19 18]
Cand prob for sample[-1] in batch: [0.0, 1e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99328, 0.00663]
### reward for the batch: 2
### loss for the batch: 8.622459411621094

Batch: 5
cids for sample[-1] in batch: [19 18]
Cand prob for sample[-1] in batch: [0.0, 3e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00032, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 2e-05, 1e-05, 0.98629, 0.01332]
### reward for the batch: 10
### loss for the batch: 55.46089172363281

Batch: 6
cids for sample[-1] in batch: [19 18]
Cand prob for sample[-1] in batch: [0.0, 3e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00088, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 1e-05, 0.94408, 0.05499]
### reward for the batch: -2
### loss for the batch: -0.40088820457458496

Batch: 7
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 0.00033, 3e-05, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.00461, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2e-05, 2e-05, 0.53492, 0.46007]
### reward for the batch: 4
### loss for the batch: 7.830842971801758

============================================
### Epoch: 1 / 20
### Total reward: 38, Total loss: 166.2949, Best reward: 42 at epoch 0, Best loss: 157.24735 at epoch 0

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_1.pt
CacheInfo(hits=35, misses=285, maxsize=10000, currsize=285)
============================================

Epoch: 2
Batch: 0
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 0.0004, 1e-05, 0.0, 0.0, 1e-05, 0.0, 1e-05, 0.0, 0.00478, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2e-05, 0.05078, 0.94398]
### reward for the batch: 2
### loss for the batch: 2.1349334716796875

Batch: 1
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 7e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00227, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01952, 0.97814]
### reward for the batch: 8
### loss for the batch: 34.8324089050293

Batch: 2
cids for sample[-1] in batch: [18 19]
Cand prob for sample[-1] in batch: [0.0, 0.00049, 1e-05, 0.0, 0.0, 1e-05, 0.0, 1e-05, 0.0, 0.0351, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 2e-05, 0.01409, 0.95026]
### reward for the batch: 2
### loss for the batch: 1.094085693359375

Batch: 3
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.0, 0.00116, 1e-05, 0.0, 0.0, 0.0002, 0.0, 6e-05, 0.0, 0.30774, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.0, 4e-05, 0.00081, 0.68997]
### reward for the batch: 8
### loss for the batch: 18.644027709960938

Batch: 4
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.00054, 0.0, 0.0, 0.0, 0.0001, 0.0, 2e-05, 0.0, 0.62077, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.0, 1e-05, 0.00044, 0.3781]
### reward for the batch: 10
### loss for the batch: 14.894501686096191

Batch: 5
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.00062, 0.0, 0.0, 0.0, 7e-05, 0.0, 2e-05, 0.0, 0.85912, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.0, 1e-05, 0.00019, 0.13994]
### reward for the batch: 2
### loss for the batch: 7.214296340942383

Batch: 6
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 3e-05, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 0.99183, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00813]
### reward for the batch: 8
### loss for the batch: 30.698129653930664

Batch: 7
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.00039, 0.0, 0.0, 0.0, 3e-05, 0.0, 1e-05, 0.0, 0.92297, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00015, 0.07645]
### reward for the batch: 14
### loss for the batch: 49.74454879760742

============================================
### Epoch: 2 / 20
### Total reward: 54, Total loss: 159.25693, Best reward: 54 at epoch 2, Best loss: 157.24735 at epoch 0

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_2.pt
saved the best reward ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_reward.pt
CacheInfo(hits=56, misses=424, maxsize=10000, currsize=424)
============================================

Epoch: 3
Batch: 0
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [1e-05, 0.00178, 1e-05, 0.0, 0.0, 0.00038, 0.0, 8e-05, 0.0, 0.49757, 0.0, 0.0, 0.0, 0.0, 2e-05, 0.0, 0.0, 5e-05, 0.00055, 0.49954]
### reward for the batch: 0
### loss for the batch: 1.242516040802002

Batch: 1
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.0, 0.00049, 1e-05, 0.0, 0.0, 5e-05, 0.0, 1e-05, 0.0, 0.07775, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.00062, 0.92107]
### reward for the batch: 4
### loss for the batch: 2.4437854290008545

Batch: 2
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.00086, 3e-05, 0.0, 0.0, 0.00016, 0.0, 0.0001, 0.0, 0.03349, 0.0, 0.0, 1e-05, 0.0, 1e-05, 0.0, 1e-05, 4e-05, 0.00087, 0.96442]
### reward for the batch: 2
### loss for the batch: -1.8574774265289307

Batch: 3
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [6e-05, 0.00077, 1e-05, 0.0, 1e-05, 0.00086, 1e-05, 0.00025, 0.0, 0.02818, 0.0, 1e-05, 0.0, 0.0, 2e-05, 1e-05, 0.0, 7e-05, 0.0001, 0.96961]
### reward for the batch: 8
### loss for the batch: 32.08781814575195

Batch: 4
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [1e-05, 0.00044, 1e-05, 0.0, 0.0, 0.00029, 0.0, 8e-05, 0.0, 0.01587, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2e-05, 0.00016, 0.9831]
### reward for the batch: 8
### loss for the batch: 35.96620178222656

Batch: 5
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [2e-05, 0.00125, 4e-05, 0.0, 1e-05, 0.00024, 0.0, 0.00017, 0.0, 0.05615, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 1e-05, 4e-05, 0.00047, 0.94159]
### reward for the batch: 6
### loss for the batch: 19.555614471435547

Batch: 6
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.0, 0.00068, 1e-05, 0.0, 0.0, 0.00012, 0.0, 0.0001, 0.0, 0.10826, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2e-05, 0.0001, 0.89069]
### reward for the batch: 6
### loss for the batch: 10.468212127685547

Batch: 7
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.00288, 0.00012, 0.0, 0.0, 6e-05, 0.0, 4e-05, 0.0, 0.52342, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 2e-05, 0.00219, 0.47123]
### reward for the batch: 12
### loss for the batch: 17.025344848632812

============================================
### Epoch: 3 / 20
### Total reward: 46, Total loss: 116.93202, Best reward: 54 at epoch 2, Best loss: 116.93202 at epoch 3

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_3.pt
saved the best loss ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_loss.pt
CacheInfo(hits=126, misses=514, maxsize=10000, currsize=514)
============================================

Epoch: 4
Batch: 0
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [3e-05, 0.00596, 0.00017, 0.0, 2e-05, 0.00021, 1e-05, 0.00018, 0.0, 0.77881, 0.0, 0.0, 2e-05, 1e-05, 2e-05, 1e-05, 2e-05, 0.00011, 0.00297, 0.21143]
### reward for the batch: 4
### loss for the batch: 6.976962566375732

Batch: 1
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.0, 0.00193, 5e-05, 0.0, 0.0, 1e-05, 0.0, 2e-05, 0.0, 0.90594, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2e-05, 0.00253, 0.08948]
### reward for the batch: 4
### loss for the batch: 3.9400506019592285

Batch: 2
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.00396, 0.00018, 0.0, 1e-05, 4e-05, 0.0, 0.00013, 0.0, 0.90873, 0.0, 0.0, 3e-05, 1e-05, 2e-05, 0.0, 3e-05, 6e-05, 0.00407, 0.08273]
### reward for the batch: 4
### loss for the batch: 10.8399658203125

Batch: 3
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [4e-05, 0.00415, 0.00012, 2e-05, 4e-05, 0.00019, 4e-05, 0.00025, 0.0, 0.93071, 1e-05, 1e-05, 2e-05, 1e-05, 7e-05, 2e-05, 2e-05, 0.00012, 0.00055, 0.06361]
### reward for the batch: 4
### loss for the batch: 11.87691879272461

Batch: 4
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [1e-05, 0.00362, 9e-05, 0.0, 1e-05, 8e-05, 1e-05, 0.00011, 0.0, 0.88198, 0.0, 0.0, 1e-05, 1e-05, 3e-05, 0.0, 1e-05, 5e-05, 0.00111, 0.11287]
### reward for the batch: 8
### loss for the batch: 22.12881851196289

Batch: 5
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [2e-05, 0.00588, 0.00026, 1e-05, 3e-05, 7e-05, 1e-05, 0.00019, 0.0, 0.74139, 1e-05, 0.0, 2e-05, 1e-05, 2e-05, 1e-05, 3e-05, 9e-05, 0.00186, 0.2501]
### reward for the batch: 2
### loss for the batch: -0.300449013710022

Batch: 6
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.0, 0.00241, 6e-05, 0.0, 0.0, 3e-05, 0.0, 8e-05, 0.0, 0.3305, 0.0, 0.0, 1e-05, 0.0, 1e-05, 0.0, 1e-05, 5e-05, 0.00026, 0.66658]
### reward for the batch: 8
### loss for the batch: 12.274689674377441

Batch: 7
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.00351, 0.0003, 0.0, 0.0, 1e-05, 0.0, 2e-05, 0.0, 0.18515, 1e-05, 0.0, 1e-05, 0.0, 1e-05, 0.0, 1e-05, 2e-05, 0.00191, 0.80904]
### reward for the batch: 14
### loss for the batch: 33.16038131713867

============================================
### Epoch: 4 / 20
### Total reward: 48, Total loss: 100.89734, Best reward: 54 at epoch 2, Best loss: 100.89734 at epoch 4

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_4.pt
saved the best loss ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_loss.pt
CacheInfo(hits=212, misses=588, maxsize=10000, currsize=588)
============================================

Epoch: 5
Batch: 0
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [3e-05, 0.01131, 0.00085, 2e-05, 5e-05, 0.00012, 1e-05, 0.00019, 0.0, 0.21551, 4e-05, 0.0, 5e-05, 2e-05, 6e-05, 2e-05, 7e-05, 0.00027, 0.00416, 0.76724]
### reward for the batch: -2
### loss for the batch: -7.20206356048584

Batch: 1
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.0, 0.00408, 0.00033, 0.0, 0.0, 1e-05, 0.0, 3e-05, 0.0, 0.18346, 1e-05, 0.0, 1e-05, 0.0, 1e-05, 0.0, 2e-05, 5e-05, 0.003, 0.80896]
### reward for the batch: 6
### loss for the batch: 17.452299118041992

Batch: 2
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [1e-05, 0.01066, 0.0013, 2e-05, 5e-05, 8e-05, 0.0, 0.00044, 0.0, 0.32374, 6e-05, 0.0, 0.00019, 2e-05, 8e-05, 2e-05, 0.00023, 0.00031, 0.00698, 0.6558]
### reward for the batch: 2
### loss for the batch: 13.402048110961914

Batch: 3
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.00027, 0.01603, 0.00143, 0.00032, 0.00043, 0.00069, 0.00024, 0.00168, 9e-05, 0.39779, 0.00027, 9e-05, 0.00025, 0.0001, 0.00059, 0.00019, 0.00026, 0.0012, 0.00154, 0.57652]
### reward for the batch: 8
### loss for the batch: 20.659008026123047

Batch: 4
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0001, 0.01401, 0.00106, 7e-05, 0.00014, 0.00037, 0.00011, 0.00118, 2e-05, 0.56104, 0.00013, 3e-05, 0.00017, 7e-05, 0.00033, 7e-05, 0.00016, 0.00063, 0.0029, 0.41742]
### reward for the batch: 4
### loss for the batch: 6.074035167694092

Batch: 5
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [0.0001, 0.01341, 0.00144, 0.0001, 0.00029, 0.0002, 4e-05, 0.00122, 0.0, 0.67603, 0.00013, 0.0, 0.00019, 6e-05, 0.00016, 0.0001, 0.00021, 0.00049, 0.00299, 0.30284]
### reward for the batch: 6
### loss for the batch: 16.129302978515625

Batch: 6
cids for sample[-1] in batch: [ 9 19]
Cand prob for sample[-1] in batch: [3e-05, 0.0073, 0.0004, 2e-05, 5e-05, 9e-05, 2e-05, 0.00113, 1e-05, 0.71551, 3e-05, 1e-05, 0.00011, 3e-05, 0.00011, 3e-05, 9e-05, 0.00038, 0.00068, 0.27397]
### reward for the batch: 6
### loss for the batch: 21.408557891845703

Batch: 7
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [3e-05, 0.01451, 0.00402, 0.0001, 0.00017, 9e-05, 2e-05, 0.00043, 0.0, 0.71065, 0.00029, 0.0, 0.00016, 2e-05, 0.00011, 4e-05, 0.00026, 0.00031, 0.01011, 0.2587]
### reward for the batch: 12
### loss for the batch: 41.406394958496094

============================================
### Epoch: 5 / 20
### Total reward: 42, Total loss: 129.32958, Best reward: 54 at epoch 2, Best loss: 100.89734 at epoch 4

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_5.pt
CacheInfo(hits=343, misses=617, maxsize=10000, currsize=617)
============================================

Epoch: 6
Batch: 0
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.00317, 0.07722, 0.03536, 0.00305, 0.00628, 0.00245, 0.00175, 0.01379, 0.00016, 0.49021, 0.00408, 0.0001, 0.00797, 0.00301, 0.00305, 0.00355, 0.01166, 0.01523, 0.09549, 0.22241]
### reward for the batch: -2
### loss for the batch: 0.08844733238220215

Batch: 1
cids for sample[-1] in batch: [16  9]
Cand prob for sample[-1] in batch: [0.00079, 0.05423, 0.05859, 0.00124, 0.00338, 0.00094, 0.00036, 0.00931, 5e-05, 0.30976, 0.00376, 2e-05, 0.0131, 0.00219, 0.00125, 0.0021, 0.02214, 0.01494, 0.31982, 0.18203]
### reward for the batch: 8
### loss for the batch: 30.065589904785156

Batch: 2
cids for sample[-1] in batch: [13 18]
Cand prob for sample[-1] in batch: [0.00277, 0.04519, 0.07531, 0.00464, 0.00932, 0.00146, 0.0008, 0.0443, 0.00021, 0.13596, 0.00839, 7e-05, 0.07019, 0.00688, 0.00336, 0.00637, 0.11618, 0.03204, 0.36805, 0.0685]
### reward for the batch: -2
### loss for the batch: -3.3229775428771973

Batch: 3
cids for sample[-1] in batch: [6 4]
Cand prob for sample[-1] in batch: [0.06007, 0.03914, 0.05123, 0.05252, 0.05824, 0.01081, 0.04697, 0.12197, 0.01804, 0.05464, 0.02898, 0.00636, 0.07209, 0.0312, 0.01912, 0.05464, 0.10394, 0.09735, 0.04229, 0.03039]
### reward for the batch: 6
### loss for the batch: 30.564315795898438

Batch: 4
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.04834, 0.04105, 0.04003, 0.02474, 0.03706, 0.01062, 0.04427, 0.15497, 0.01816, 0.07845, 0.02183, 0.00897, 0.08211, 0.02895, 0.02332, 0.04965, 0.11187, 0.0802, 0.06697, 0.02844]
### reward for the batch: 10
### loss for the batch: 48.78148651123047

Batch: 5
cids for sample[-1] in batch: [12  9]
Cand prob for sample[-1] in batch: [0.03205, 0.06003, 0.05942, 0.02827, 0.06828, 0.00508, 0.01257, 0.11101, 0.00241, 0.21672, 0.0209, 0.00065, 0.05797, 0.00953, 0.01047, 0.04913, 0.09254, 0.04227, 0.05708, 0.06361]
### reward for the batch: 8
### loss for the batch: 46.37041473388672

Batch: 6
cids for sample[-1] in batch: [19 12]
Cand prob for sample[-1] in batch: [0.04316, 0.0439, 0.01922, 0.01627, 0.03559, 0.0066, 0.04926, 0.18999, 0.04588, 0.19887, 0.00931, 0.01302, 0.06277, 0.0092, 0.02258, 0.04216, 0.06584, 0.0668, 0.00858, 0.05101]
### reward for the batch: 8
### loss for the batch: 39.88749694824219

Batch: 7
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.02123, 0.06261, 0.14951, 0.03904, 0.05817, 0.00485, 0.01629, 0.0306, 0.00256, 0.18751, 0.07262, 0.00049, 0.04966, 0.00262, 0.01117, 0.02654, 0.10182, 0.02792, 0.07009, 0.06469]
### reward for the batch: 16
### loss for the batch: 83.59705352783203

============================================
### Epoch: 6 / 20
### Total reward: 52, Total loss: 276.03183, Best reward: 54 at epoch 2, Best loss: 100.89734 at epoch 4

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_6.pt
CacheInfo(hits=370, misses=750, maxsize=10000, currsize=750)
============================================

Epoch: 7
Batch: 0
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.18731, 0.01729, 0.03852, 0.04141, 0.07733, 0.01091, 0.16175, 0.04136, 0.04389, 0.01141, 0.02677, 0.00975, 0.05381, 0.01642, 0.01614, 0.08703, 0.07123, 0.06344, 0.01759, 0.00663]
### reward for the batch: 8
### loss for the batch: 39.427001953125

Batch: 1
cids for sample[-1] in batch: [10 18]
Cand prob for sample[-1] in batch: [0.04536, 0.02226, 0.11796, 0.02095, 0.05764, 0.00746, 0.04249, 0.02645, 0.02409, 0.01662, 0.05048, 0.00366, 0.13883, 0.01107, 0.00995, 0.05302, 0.19857, 0.06946, 0.06932, 0.01436]
### reward for the batch: 10
### loss for the batch: 40.02024459838867

Batch: 2
cids for sample[-1] in batch: [10 16]
Cand prob for sample[-1] in batch: [0.0091, 0.01828, 0.10879, 0.00932, 0.02594, 0.00169, 0.00639, 0.0184, 0.00281, 0.0207, 0.03095, 0.00036, 0.25217, 0.00228, 0.00458, 0.01436, 0.35772, 0.02724, 0.07695, 0.012]
### reward for the batch: 2
### loss for the batch: 15.249872207641602

Batch: 3
cids for sample[-1] in batch: [17  0]
Cand prob for sample[-1] in batch: [0.16542, 0.00286, 0.01051, 0.03012, 0.04766, 0.01131, 0.30802, 0.01548, 0.19789, 0.00104, 0.01622, 0.05787, 0.02404, 0.00711, 0.00919, 0.03368, 0.02296, 0.03491, 0.00186, 0.00185]
### reward for the batch: 6
### loss for the batch: 28.799880981445312

Batch: 4
cids for sample[-1] in batch: [4 8]
Cand prob for sample[-1] in batch: [0.13178, 0.01008, 0.03109, 0.01494, 0.04229, 0.02127, 0.23991, 0.02708, 0.10604, 0.00651, 0.02785, 0.05529, 0.07204, 0.01183, 0.01647, 0.03071, 0.07308, 0.05471, 0.01707, 0.00996]
### reward for the batch: 6
### loss for the batch: 17.730566024780273

Batch: 5
cids for sample[-1] in batch: [19  3]
Cand prob for sample[-1] in batch: [0.00943, 0.04508, 0.11297, 0.00706, 0.05401, 0.00301, 0.00403, 0.01727, 0.00099, 0.20769, 0.02539, 0.00018, 0.13597, 0.00148, 0.00516, 0.01636, 0.16391, 0.02337, 0.05729, 0.10935]
### reward for the batch: 12
### loss for the batch: 50.34467315673828

Batch: 6
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.00035, 0.01586, 0.00401, 0.00012, 0.00129, 0.00032, 0.00037, 0.00329, 0.00023, 0.78029, 0.00044, 9e-05, 0.01089, 5e-05, 0.00118, 0.00037, 0.00866, 0.00296, 0.00221, 0.167]
### reward for the batch: 8
### loss for the batch: 40.448699951171875

Batch: 7
cids for sample[-1] in batch: [2 9]
Cand prob for sample[-1] in batch: [1e-05, 0.01085, 0.0151, 8e-05, 0.00044, 4e-05, 1e-05, 0.0001, 0.0, 0.87894, 0.00103, 0.0, 0.00171, 0.0, 0.00011, 7e-05, 0.00327, 0.00024, 0.01124, 0.07677]
### reward for the batch: 12
### loss for the batch: 50.67380905151367

============================================
### Epoch: 7 / 20
### Total reward: 64, Total loss: 282.69475, Best reward: 64 at epoch 7, Best loss: 100.89734 at epoch 4

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_7.pt
saved the best reward ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_reward.pt
CacheInfo(hits=392, misses=888, maxsize=10000, currsize=888)
============================================

Epoch: 8
Batch: 0
cids for sample[-1] in batch: [ 2 18]
Cand prob for sample[-1] in batch: [0.00259, 0.05202, 0.05982, 0.00123, 0.01015, 0.00156, 0.0013, 0.00343, 8e-05, 0.56034, 0.00507, 3e-05, 0.03168, 0.00052, 0.00191, 0.00261, 0.03226, 0.01266, 0.06762, 0.15311]
### reward for the batch: 0
### loss for the batch: -1.2643437385559082

Batch: 1
cids for sample[-1] in batch: [18  9]
Cand prob for sample[-1] in batch: [0.0001, 0.02903, 0.09248, 0.00016, 0.00238, 0.00022, 5e-05, 0.0008, 1e-05, 0.38831, 0.00283, 0.0, 0.06229, 0.00013, 0.00029, 0.00068, 0.06352, 0.00468, 0.25388, 0.09817]
### reward for the batch: 12
### loss for the batch: 45.88908004760742

Batch: 2
cids for sample[-1] in batch: [18  9]
Cand prob for sample[-1] in batch: [2e-05, 0.02006, 0.07095, 8e-05, 0.00128, 4e-05, 1e-05, 0.00081, 0.0, 0.35974, 0.00113, 0.0, 0.16863, 4e-05, 0.0002, 0.0003, 0.09913, 0.00205, 0.23066, 0.04485]
### reward for the batch: 4
### loss for the batch: 13.089069366455078

Batch: 3
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.04173, 0.03762, 0.11111, 0.00972, 0.07783, 0.0118, 0.03987, 0.03112, 0.00145, 0.07093, 0.01539, 0.00076, 0.15378, 0.0083, 0.00619, 0.01432, 0.06266, 0.11343, 0.10791, 0.08409]
### reward for the batch: 8
### loss for the batch: 32.81232452392578

Batch: 4
cids for sample[-1] in batch: [12 18]
Cand prob for sample[-1] in batch: [0.00907, 0.02593, 0.07764, 0.0014, 0.01957, 0.00369, 0.01373, 0.02196, 0.00019, 0.07515, 0.00425, 0.00014, 0.21561, 0.00469, 0.00246, 0.00472, 0.05811, 0.04575, 0.37837, 0.03756]
### reward for the batch: 4
### loss for the batch: 10.609734535217285

Batch: 5
cids for sample[-1] in batch: [18  9]
Cand prob for sample[-1] in batch: [0.00016, 0.02048, 0.05508, 0.0003, 0.00873, 0.00015, 7e-05, 0.0027, 0.0, 0.59448, 0.00091, 0.0, 0.07699, 0.00015, 0.00031, 0.00106, 0.01597, 0.00325, 0.16207, 0.05714]
### reward for the batch: 10
### loss for the batch: 35.91508102416992

Batch: 6
cids for sample[-1] in batch: [ 9 12]
Cand prob for sample[-1] in batch: [0.00018, 0.01722, 0.0152, 7e-05, 0.00329, 0.00018, 0.00032, 0.00924, 1e-05, 0.66574, 0.00014, 0.0, 0.11276, 0.00019, 0.00044, 0.00039, 0.00886, 0.00654, 0.05857, 0.10066]
### reward for the batch: -2
### loss for the batch: -3.7290079593658447

Batch: 7
cids for sample[-1] in batch: [ 9 18]
Cand prob for sample[-1] in batch: [0.0, 0.00907, 0.02304, 5e-05, 0.00094, 2e-05, 0.0, 0.00012, 0.0, 0.87184, 0.00031, 0.0, 0.00615, 1e-05, 5e-05, 7e-05, 0.00137, 0.00022, 0.06006, 0.02669]
### reward for the batch: 10
### loss for the batch: 33.193660736083984

============================================
### Epoch: 8 / 20
### Total reward: 46, Total loss: 166.5156, Best reward: 64 at epoch 7, Best loss: 100.89734 at epoch 4

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_8.pt
CacheInfo(hits=437, misses=1003, maxsize=10000, currsize=1003)
============================================

Epoch: 9
Batch: 0
cids for sample[-1] in batch: [18 12]
Cand prob for sample[-1] in batch: [0.00581, 0.01108, 0.07957, 0.00108, 0.04011, 0.00121, 0.0045, 0.01689, 3e-05, 0.01041, 0.00151, 1e-05, 0.33065, 0.00364, 0.0006, 0.00625, 0.02665, 0.05998, 0.38698, 0.01305]
### reward for the batch: 2
### loss for the batch: -2.0829334259033203

Batch: 1
cids for sample[-1] in batch: [ 2 12]
Cand prob for sample[-1] in batch: [7e-05, 0.00405, 0.04623, 5e-05, 0.00435, 7e-05, 6e-05, 0.00267, 0.0, 0.00729, 0.0003, 0.0, 0.47972, 0.00028, 5e-05, 0.00081, 0.0231, 0.00874, 0.41572, 0.00645]
### reward for the batch: 12
### loss for the batch: 38.338478088378906

Batch: 2
cids for sample[-1] in batch: [18 12]
Cand prob for sample[-1] in batch: [0.0, 0.00138, 0.00884, 1e-05, 0.00085, 0.0, 0.0, 0.00131, 0.0, 0.00621, 3e-05, 0.0, 0.90515, 2e-05, 2e-05, 0.00013, 0.0138, 0.00127, 0.05932, 0.00166]
### reward for the batch: 2
### loss for the batch: 12.240623474121094

Batch: 3
cids for sample[-1] in batch: [12  4]
Cand prob for sample[-1] in batch: [0.0388, 0.00085, 0.00717, 0.00161, 0.04682, 0.00172, 0.04529, 0.11635, 0.00042, 5e-05, 0.00045, 0.00026, 0.54404, 0.0094, 0.00048, 0.00776, 0.01359, 0.14501, 0.01872, 0.00122]
### reward for the batch: 8
### loss for the batch: 19.342424392700195

Batch: 4
cids for sample[-1] in batch: [17 12]
Cand prob for sample[-1] in batch: [0.00256, 0.00211, 0.00897, 0.00029, 0.01203, 0.00048, 0.00661, 0.0493, 7e-05, 0.00053, 0.00027, 5e-05, 0.80831, 0.00237, 0.00038, 0.00261, 0.0176, 0.03544, 0.04796, 0.00204]
### reward for the batch: 4
### loss for the batch: 9.500311851501465

Batch: 5
cids for sample[-1] in batch: [9 4]
Cand prob for sample[-1] in batch: [3e-05, 0.01695, 0.03003, 0.00018, 0.01426, 4e-05, 3e-05, 0.00463, 0.0, 0.28722, 0.00027, 0.0, 0.55547, 8e-05, 0.00025, 0.00117, 0.0098, 0.00267, 0.05267, 0.02423]
### reward for the batch: 6
### loss for the batch: 23.21294593811035

Batch: 6
cids for sample[-1] in batch: [12  9]
Cand prob for sample[-1] in batch: [4e-05, 0.02063, 0.00775, 7e-05, 0.00508, 9e-05, 0.0002, 0.02335, 2e-05, 0.53596, 7e-05, 1e-05, 0.32731, 0.00012, 0.00084, 0.00057, 0.00552, 0.00682, 0.01201, 0.05356]
### reward for the batch: 6
### loss for the batch: 9.706180572509766

Batch: 7
cids for sample[-1] in batch: [1 9]
Cand prob for sample[-1] in batch: [0.0, 0.00129, 0.00031, 0.0, 3e-05, 0.0, 0.0, 0.0, 0.0, 0.99684, 1e-05, 0.0, 0.00017, 0.0, 1e-05, 0.0, 1e-05, 0.0, 0.00031, 0.001]
### reward for the batch: 10
### loss for the batch: 38.69606399536133

============================================
### Epoch: 9 / 20
### Total reward: 50, Total loss: 148.95409, Best reward: 64 at epoch 7, Best loss: 100.89734 at epoch 4

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_9.pt
CacheInfo(hits=465, misses=1135, maxsize=10000, currsize=1135)
============================================

Epoch: 10
Batch: 0
cids for sample[-1] in batch: [18  7]
Cand prob for sample[-1] in batch: [0.0035, 0.0516, 0.09616, 0.00471, 0.13283, 0.00208, 0.00549, 0.07157, 0.00015, 0.0508, 0.00444, 6e-05, 0.28596, 0.0033, 0.00457, 0.01642, 0.02842, 0.06958, 0.14323, 0.02514]
### reward for the batch: 0
### loss for the batch: -15.010540008544922

Batch: 1
cids for sample[-1] in batch: [19 18]
Cand prob for sample[-1] in batch: [0.0001, 0.04166, 0.16053, 0.00089, 0.03351, 0.00042, 0.00014, 0.01475, 3e-05, 0.08499, 0.00435, 1e-05, 0.23577, 0.00061, 0.00118, 0.00539, 0.04608, 0.01688, 0.32969, 0.02301]
### reward for the batch: 8
### loss for the batch: 19.47744369506836

Batch: 2
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.02739, 0.04519, 0.00017, 0.00605, 4e-05, 1e-05, 0.00181, 0.0, 0.81005, 0.00081, 0.0, 0.04417, 2e-05, 0.00072, 0.0006, 0.00747, 0.00081, 0.04056, 0.01412]
### reward for the batch: 6
### loss for the batch: 13.815988540649414

Batch: 3
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.08991, 0.00242, 0.00677, 0.00912, 0.20664, 0.00787, 0.06872, 0.47091, 0.00114, 0.00023, 0.00193, 0.00165, 0.00697, 0.00658, 0.00238, 0.01396, 0.00152, 0.09161, 0.00447, 0.00517]
### reward for the batch: 6
### loss for the batch: 8.499085426330566

Batch: 4
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.07585, 0.00208, 0.01077, 0.00338, 0.10682, 0.00716, 0.07987, 0.56124, 0.00088, 0.00014, 0.00213, 0.0017, 0.00941, 0.00782, 0.00191, 0.01172, 0.00261, 0.10013, 0.01088, 0.0035]
### reward for the batch: 4
### loss for the batch: 11.515918731689453

Batch: 5
cids for sample[-1] in batch: [4 9]
Cand prob for sample[-1] in batch: [0.00144, 0.02174, 0.05249, 0.00569, 0.39292, 0.00132, 0.00068, 0.0562, 4e-05, 0.37403, 0.00375, 2e-05, 0.00608, 0.00025, 0.0029, 0.01146, 0.00114, 0.00663, 0.00736, 0.05386]
### reward for the batch: 8
### loss for the batch: 28.988853454589844

Batch: 6
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.06434, 0.00024, 0.00113, 0.00032, 0.03678, 0.00199, 0.05014, 0.76736, 0.00049, 4e-05, 0.0001, 0.00127, 0.00104, 0.00142, 0.00044, 0.00254, 0.00019, 0.06553, 0.00037, 0.00428]
### reward for the batch: 4
### loss for the batch: -6.696313858032227

Batch: 7
cids for sample[-1] in batch: [10  9]
Cand prob for sample[-1] in batch: [2e-05, 0.00433, 0.01285, 0.00044, 0.01393, 0.0001, 2e-05, 0.00098, 0.0, 0.95562, 0.0009, 0.0, 0.00029, 1e-05, 0.00038, 0.00041, 7e-05, 0.00015, 0.00093, 0.00859]
### reward for the batch: 14
### loss for the batch: 43.12194061279297

============================================
### Epoch: 10 / 20
### Total reward: 50, Total loss: 103.71238, Best reward: 64 at epoch 7, Best loss: 100.89734 at epoch 4

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_10.pt
CacheInfo(hits=512, misses=1248, maxsize=10000, currsize=1248)
============================================

Epoch: 11
Batch: 0
cids for sample[-1] in batch: [4 0]
Cand prob for sample[-1] in batch: [0.45395, 0.00013, 0.00648, 0.00104, 0.09323, 0.00378, 0.12899, 0.21736, 0.00029, 0.0, 0.00058, 0.0003, 0.00099, 0.00343, 0.0002, 0.00818, 0.00023, 0.07806, 0.00177, 0.00101]
### reward for the batch: 4
### loss for the batch: -6.286135196685791

Batch: 1
cids for sample[-1] in batch: [4 2]
Cand prob for sample[-1] in batch: [0.04373, 0.0024, 0.38886, 0.00223, 0.17374, 0.00816, 0.01786, 0.09675, 0.00046, 0.00074, 0.01693, 0.00015, 0.01474, 0.00564, 0.00061, 0.02608, 0.00616, 0.11252, 0.05763, 0.02461]
### reward for the batch: 10
### loss for the batch: 24.920469284057617

Batch: 2
cids for sample[-1] in batch: [2 9]
Cand prob for sample[-1] in batch: [2e-05, 0.0021, 0.02454, 0.00013, 0.00453, 0.00015, 2e-05, 0.00065, 1e-05, 0.95373, 0.00076, 0.0, 0.00087, 1e-05, 0.00038, 0.00051, 0.00027, 0.00031, 0.00144, 0.00956]
### reward for the batch: 0
### loss for the batch: -20.459735870361328

Batch: 3
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.31818, 0.00012, 0.00173, 0.00184, 0.109, 0.00834, 0.33788, 0.18451, 0.00049, 0.00033, 0.00036, 0.00092, 0.0001, 0.001, 0.00054, 0.0068, 2e-05, 0.02469, 0.00011, 0.00304]
### reward for the batch: 4
### loss for the batch: -45.20530319213867

Batch: 4
cids for sample[-1] in batch: [9 7]
Cand prob for sample[-1] in batch: [0.08625, 0.00184, 0.02256, 0.00242, 0.10314, 0.02427, 0.24307, 0.32133, 0.00052, 0.08991, 0.00235, 0.00102, 0.00079, 0.00216, 0.00324, 0.01498, 0.00015, 0.04068, 0.00165, 0.03766]
### reward for the batch: 4
### loss for the batch: 38.64017105102539

Batch: 5
cids for sample[-1] in batch: [19  9]
Cand prob for sample[-1] in batch: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99998, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05]
### reward for the batch: 12
### loss for the batch: 62.747642517089844

Batch: 6
cids for sample[-1] in batch: [19  6]
Cand prob for sample[-1] in batch: [0.11593, 4e-05, 0.00748, 0.0001, 0.03753, 0.00349, 0.25156, 0.45641, 0.00022, 0.00027, 0.00018, 0.00028, 0.00046, 0.0008, 0.00012, 0.00362, 5e-05, 0.10839, 0.00014, 0.01294]
### reward for the batch: 4
### loss for the batch: -44.535308837890625

Batch: 7
cids for sample[-1] in batch: [2 9]
Cand prob for sample[-1] in batch: [0.0, 1e-05, 0.0039, 0.0, 0.00011, 0.0, 0.0, 0.0, 0.0, 0.99585, 2e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00011]
### reward for the batch: 10
### loss for the batch: 39.86912536621094

============================================
### Epoch: 11 / 20
### Total reward: 48, Total loss: 49.69093, Best reward: 64 at epoch 7, Best loss: 49.69093 at epoch 11

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_11.pt
saved the best loss ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_loss.pt
CacheInfo(hits=568, misses=1352, maxsize=10000, currsize=1352)
============================================

Epoch: 12
Batch: 0
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.5936, 0.0, 0.0104, 1e-05, 0.00802, 0.0003, 0.26195, 0.02114, 3e-05, 0.0, 0.00015, 1e-05, 0.00018, 0.00063, 0.0, 0.00115, 2e-05, 0.10214, 0.00023, 4e-05]
### reward for the batch: 8
### loss for the batch: 10.635005950927734

Batch: 1
cids for sample[-1] in batch: [ 2 17]
Cand prob for sample[-1] in batch: [0.07942, 0.0, 0.42325, 2e-05, 0.00915, 0.00085, 0.02844, 0.03599, 7e-05, 0.0, 0.00288, 1e-05, 0.00538, 0.00425, 0.0, 0.00326, 0.00116, 0.38934, 0.0157, 0.00082]
### reward for the batch: 10
### loss for the batch: 15.048169136047363

Batch: 2
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.00216, 7e-05, 0.74791, 8e-05, 0.02313, 0.00124, 0.00155, 0.04127, 7e-05, 0.00019, 0.00505, 1e-05, 0.03024, 0.00166, 3e-05, 0.00497, 0.0057, 0.10566, 0.02276, 0.00625]
### reward for the batch: 8
### loss for the batch: 6.7798614501953125

Batch: 3
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.4596, 0.0, 0.0, 0.0, 0.00019, 1e-05, 0.50946, 0.01911, 1e-05, 0.0, 0.0, 1e-05, 0.0, 6e-05, 0.0, 2e-05, 0.0, 0.01154, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: -40.583526611328125

Batch: 4
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.28208, 0.0, 0.0, 0.0, 0.00026, 4e-05, 0.62589, 0.06144, 3e-05, 0.0, 0.0, 5e-05, 1e-05, 0.0004, 0.0, 7e-05, 0.0, 0.02973, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: 5.528293132781982

Batch: 5
cids for sample[-1] in batch: [4 9]
Cand prob for sample[-1] in batch: [0.0, 0.0, 0.0001, 1e-05, 0.00166, 2e-05, 0.0, 0.0001, 0.0, 0.99797, 0.0, 0.0, 0.0, 0.0, 1e-05, 5e-05, 0.0, 1e-05, 0.0, 5e-05]
### reward for the batch: 8
### loss for the batch: 12.785239219665527

Batch: 6
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.06535, 0.0, 0.0, 0.0, 0.00375, 0.00017, 0.21333, 0.69763, 4e-05, 0.0, 0.0, 9e-05, 2e-05, 0.00015, 0.0, 0.00041, 0.0, 0.01905, 0.0, 0.0]
### reward for the batch: 4
### loss for the batch: -69.61896514892578

Batch: 7
cids for sample[-1] in batch: [14  9]
Cand prob for sample[-1] in batch: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
### reward for the batch: 12
### loss for the batch: 32.78042221069336

============================================
### Epoch: 12 / 20
### Total reward: 54, Total loss: -26.6455, Best reward: 64 at epoch 7, Best loss: -26.6455 at epoch 12

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_12.pt
saved the best loss ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_loss.pt
CacheInfo(hits=595, misses=1485, maxsize=10000, currsize=1485)
============================================

Epoch: 13
Batch: 0
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.29756, 0.0, 5e-05, 7e-05, 0.03137, 0.00066, 0.58507, 0.06708, 5e-05, 0.0, 1e-05, 5e-05, 9e-05, 0.00034, 1e-05, 0.00303, 0.0, 0.01455, 1e-05, 1e-05]
### reward for the batch: 6
### loss for the batch: -26.324949264526367

Batch: 1
cids for sample[-1] in batch: [17 12]
Cand prob for sample[-1] in batch: [0.14358, 3e-05, 0.00627, 0.00029, 0.09567, 0.00649, 0.20441, 0.31388, 0.00054, 0.00013, 0.00054, 0.00023, 0.01692, 0.00802, 6e-05, 0.02432, 0.00161, 0.17306, 0.00296, 0.00097]
### reward for the batch: 8
### loss for the batch: -22.38131332397461

Batch: 2
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.04034, 0.00014, 0.00632, 0.00086, 0.18367, 0.00854, 0.04603, 0.44567, 0.0003, 0.14613, 0.0003, 0.00013, 0.02184, 0.00192, 0.00052, 0.0291, 0.00133, 0.06296, 0.00127, 0.00263]
### reward for the batch: -2
### loss for the batch: -67.75965118408203

Batch: 3
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.39976, 0.0, 0.0, 0.0, 0.00515, 3e-05, 0.55969, 0.0346, 0.0, 0.0, 0.0, 1e-05, 0.0, 1e-05, 0.0, 0.00021, 0.0, 0.00054, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: -132.4244384765625

Batch: 4
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.17782, 0.0, 0.0, 8e-05, 0.04847, 0.00148, 0.38948, 0.37321, 1e-05, 0.00162, 0.0, 4e-05, 1e-05, 5e-05, 1e-05, 0.00319, 0.0, 0.00452, 0.0, 1e-05]
### reward for the batch: 8
### loss for the batch: 149.26040649414062

Batch: 5
cids for sample[-1] in batch: [4 9]
Cand prob for sample[-1] in batch: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
### reward for the batch: 12
### loss for the batch: 52.04910659790039

Batch: 6
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.15181, 0.0, 0.0, 0.0, 0.00167, 1e-05, 0.03989, 0.80573, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6e-05, 0.0, 0.00083, 0.0, 0.0]
### reward for the batch: 6
### loss for the batch: -52.4561882019043

Batch: 7
cids for sample[-1] in batch: [4 9]
Cand prob for sample[-1] in batch: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
### reward for the batch: 14
### loss for the batch: 21.755308151245117

============================================
### Epoch: 13 / 20
### Total reward: 54, Total loss: -78.28172, Best reward: 64 at epoch 7, Best loss: -78.28172 at epoch 13

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_13.pt
saved the best loss ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_loss.pt
CacheInfo(hits=647, misses=1593, maxsize=10000, currsize=1593)
============================================

Epoch: 14
Batch: 0
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.76331, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.21338, 0.02276, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00054, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: -54.57708740234375

Batch: 1
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.40121, 0.0, 0.0, 0.0, 0.0, 0.0, 0.55936, 0.03, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00019, 0.0, 0.0, 0.0, 0.00923, 0.0, 0.0]
### reward for the batch: 6
### loss for the batch: -6.683966636657715

Batch: 2
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.1718, 0.0, 0.0, 0.0, 0.0, 0.0, 0.42079, 0.39124, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.00014, 0.0, 0.0, 0.0, 0.01601, 0.0, 0.0]
### reward for the batch: -2
### loss for the batch: -33.69321060180664

Batch: 3
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.05323, 0.0, 0.0, 0.0, 0.0, 0.0, 0.91652, 0.03023, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2e-05, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: -11.395103454589844

Batch: 4
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.00276, 0.0, 0.0, 0.0, 0.0, 0.0, 0.05917, 0.9379, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00016, 0.0, 0.0]
### reward for the batch: 8
### loss for the batch: 69.63868713378906

Batch: 5
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.00052, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00263, 0.99676, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9e-05, 0.0, 0.0]
### reward for the batch: 12
### loss for the batch: 71.05632019042969

Batch: 6
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.00027, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01393, 0.98579, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: -9.73511028289795

Batch: 7
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.00244, 0.0, 0.0, 0.0, 9e-05, 0.0, 0.04944, 0.94764, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00039, 0.0, 0.0]
### reward for the batch: 10
### loss for the batch: -3.102219581604004

============================================
### Epoch: 14 / 20
### Total reward: 40, Total loss: 21.50831, Best reward: 64 at epoch 7, Best loss: -78.28172 at epoch 13

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_14.pt
CacheInfo(hits=666, misses=1734, maxsize=10000, currsize=1734)
============================================

Epoch: 15
Batch: 0
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.0638, 0.0, 0.0, 0.0, 0.0, 0.0, 0.92053, 0.01525, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00041, 0.0, 0.0]
### reward for the batch: 4
### loss for the batch: -28.504905700683594

Batch: 1
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.5662, 0.0, 0.0, 0.0, 0.0, 0.0, 0.38778, 0.02212, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00081, 0.0, 0.0, 0.0, 0.02309, 0.0, 0.0]
### reward for the batch: 6
### loss for the batch: -11.849698066711426

Batch: 2
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.56364, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06915, 0.31947, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00036, 0.0, 0.0, 0.0, 0.04737, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: -18.88252830505371

Batch: 3
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.96454, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01265, 0.0227, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00011, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: -22.359901428222656

Batch: 4
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.20642, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03286, 0.75728, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 0.00343, 0.0, 0.0]
### reward for the batch: 6
### loss for the batch: 51.2406120300293

Batch: 5
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.02428, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00693, 0.9651, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00369, 0.0, 0.0]
### reward for the batch: 10
### loss for the batch: 29.279422760009766

Batch: 6
cids for sample[-1] in batch: [17  7]
Cand prob for sample[-1] in batch: [4e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-05, 0.99966, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0003, 0.0, 0.0]
### reward for the batch: 8
### loss for the batch: -57.70899200439453

Batch: 7
cids for sample[-1] in batch: [9 7]
Cand prob for sample[-1] in batch: [0.0008, 0.0, 0.0, 0.0, 0.00091, 2e-05, 0.00057, 0.6078, 0.0, 0.38678, 0.0, 0.0, 0.0, 0.0, 0.0, 2e-05, 0.0, 0.0031, 0.0, 0.0]
### reward for the batch: 14
### loss for the batch: -20.027076721191406

============================================
### Epoch: 15 / 20
### Total reward: 52, Total loss: -78.81307, Best reward: 64 at epoch 7, Best loss: -78.81307 at epoch 15

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_15.pt
saved the best loss ckpt to ../checkpoints_PL/exp10_rl/ckpt_best_loss.pt
CacheInfo(hits=723, misses=1837, maxsize=10000, currsize=1837)
============================================

Epoch: 16
Batch: 0
cids for sample[-1] in batch: [ 0 17]
Cand prob for sample[-1] in batch: [0.55032, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1362, 0.01554, 0.0, 0.0, 0.0, 0.0, 0.0, 8e-05, 0.0, 0.0, 0.0, 0.29787, 0.0, 0.0]
### reward for the batch: 8
### loss for the batch: -105.39874267578125

Batch: 1
cids for sample[-1] in batch: [ 6 17]
Cand prob for sample[-1] in batch: [0.04924, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03506, 0.00035, 0.0, 0.0, 0.0, 0.0, 0.00016, 0.00063, 0.0, 0.0, 0.0, 0.91455, 0.0, 0.0]
### reward for the batch: 10
### loss for the batch: -84.6312255859375

Batch: 2
cids for sample[-1] in batch: [ 0 17]
Cand prob for sample[-1] in batch: [0.01908, 0.0, 0.0, 0.0, 4e-05, 0.0, 0.01473, 0.00207, 0.0, 0.0, 0.0, 0.0, 0.00054, 8e-05, 0.0, 3e-05, 0.0, 0.96343, 0.0, 0.0]
### reward for the batch: 6
### loss for the batch: -97.23186492919922

Batch: 3
cids for sample[-1] in batch: [ 0 17]
Cand prob for sample[-1] in batch: [0.63973, 0.0, 0.0, 0.0, 0.00029, 0.0, 0.12926, 0.00088, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3e-05, 0.0, 0.22979, 0.0, 0.0]
### reward for the batch: 6
### loss for the batch: -240.15440368652344

Batch: 4
cids for sample[-1] in batch: [ 9 17]
Cand prob for sample[-1] in batch: [0.02002, 0.0, 0.0, 0.0, 0.00019, 0.00011, 0.02254, 0.00132, 0.0, 0.8688, 0.0, 0.0, 0.0, 0.0, 0.0, 4e-05, 0.0, 0.08697, 0.0, 0.0]
### reward for the batch: 4
### loss for the batch: 53.35498046875

Batch: 5
cids for sample[-1] in batch: [ 3 15]
Cand prob for sample[-1] in batch: [nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan]
### reward for the batch: 4
### loss for the batch: nan

============================================
### Epoch: 16 / 20
### Total reward: 38, Total loss: nan, Best reward: 64 at epoch 7, Best loss: -78.81307 at epoch 15

saved the ckpt to ../checkpoints_PL/exp10_rl/ckpt_16.pt
CacheInfo(hits=756, misses=1924, maxsize=10000, currsize=1924)
============================================

